@fullname = {{$random.name.name}}
@email = {{$random.email}}
@password = {{$random.internet.password}}

### auth
# @name register
POST {{base_path}}/users/register
Content-Type: application/json

{
  "fullName": "{{fullname}}",
  "email": "{{email}}",
  "password": "{{password}}"
}

### login
POST {{base_path}}/users/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

> {%
    client.global.set("access_token", response.body.token);
%}

### test who I am
GET {{base_path}}/users/me
Authorization: Bearer {{access_token}}

> {%
    client.assert(response.status == 200)
 %}


### test if internal fails
GET {{base_path}}users/internal/whoami
Authorization: Bearer {{access_token}}

> {%
    client.assert(response.status == 403)
%}

### test deletion
DELETE {{base_path}}users/me
Authorization: Bearer {{access_token}}

###
POST {{base_path}}/users/register
Content-Type: application/json

{
  "fullName": "mario",
  "email": "email",
  "password": "password"
}
###
POST {{base_path}}/users/login
Content-Type: application/json

{
  "fullName": "mario",
  "email": "email",
  "password": "password"
}